; generated by Component: ARM Compiler 5.06 update 4 (build 422) Tool: ArmCC [4d3604]
; commandline ArmCC [--c99 --list --split_sections --debug -c --asm --interleave -o.\flash\obj\mqttunsubscribeclient.o --asm_dir=.\Flash\List\ --list_dir=.\Flash\List\ --depend=.\flash\obj\mqttunsubscribeclient.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931,870 -I..\..\Libraries\CMSIS\Device\ST\STM32F10x\Include -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\User\bsp -I..\..\User\bsp\inc -I..\..\User -I..\..\Libraries\CMSIS\Include -I..\..\FreeRTOS\include -I..\..\FreeRTOS\portable\RVDS\ARM_CM3 -I..\..\MQTT -I..\..\Ethernet -I..\..\Ethernet\W5500 -I..\..\Internet\DHCP -I..\..\Internet\DNS -I..\..\User\app\src -I..\..\User\app\inc -I..\..\Internet\NTP -I..\..\Internet\HTTP -I.\RTE\_Flash -ID:\MDK5\ARM\CMSIS\5.0.1\CMSIS\Include -ID:\MDK5\Keil\STM32F1xx_DFP\2.0.0\Device\Include -D__MICROLIB -D__UVISION_VERSION=523 -D_RTE_ -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD --omf_browse=.\flash\obj\mqttunsubscribeclient.crf ..\..\MQTT\MQTTUnsubscribeClient.c]
                          THUMB

                          AREA ||i.MQTTDeserialize_unsuback||, CODE, READONLY, ALIGN=1

                  MQTTDeserialize_unsuback PROC
;;;91       */
;;;92     int MQTTDeserialize_unsuback(unsigned short* packetid, unsigned char* buf, int buflen)
000000  b5fe              PUSH     {r1-r7,lr}
;;;93     {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
000006  4616              MOV      r6,r2
;;;94     	unsigned char type = 0;
000008  2000              MOVS     r0,#0
00000a  9002              STR      r0,[sp,#8]
;;;95     	unsigned char dup = 0;
00000c  9001              STR      r0,[sp,#4]
;;;96     	int rc = 0;
00000e  2700              MOVS     r7,#0
;;;97     
;;;98     	FUNC_ENTRY;
;;;99     	rc = MQTTDeserialize_ack(&type, &dup, packetid, buf, buflen);
000010  462b              MOV      r3,r5
000012  4622              MOV      r2,r4
000014  a901              ADD      r1,sp,#4
000016  a802              ADD      r0,sp,#8
000018  9600              STR      r6,[sp,#0]
00001a  f7fffffe          BL       MQTTDeserialize_ack
00001e  4607              MOV      r7,r0
;;;100    	if (type == UNSUBACK)
000020  f89d0008          LDRB     r0,[sp,#8]
000024  280b              CMP      r0,#0xb
000026  d100              BNE      |L1.42|
;;;101    		rc = 1;
000028  2701              MOVS     r7,#1
                  |L1.42|
;;;102    	FUNC_EXIT_RC(rc);
;;;103    	return rc;
00002a  4638              MOV      r0,r7
;;;104    }
00002c  bdfe              POP      {r1-r7,pc}
;;;105    
                          ENDP


                          AREA ||i.MQTTSerialize_unsubscribe||, CODE, READONLY, ALIGN=1

                  MQTTSerialize_unsubscribe PROC
;;;48       */
;;;49     int MQTTSerialize_unsubscribe(unsigned char* buf, int buflen, unsigned char dup, unsigned short packetid,
000000  e92d5fff          PUSH     {r0-r12,lr}
;;;50     		int count, MQTTString topicFilters[])
;;;51     {
000004  4604              MOV      r4,r0
000006  460e              MOV      r6,r1
000008  4617              MOV      r7,r2
00000a  4698              MOV      r8,r3
00000c  e9dd9a0e          LDRD     r9,r10,[sp,#0x38]
;;;52     	unsigned char *ptr = buf;
000010  9403              STR      r4,[sp,#0xc]
;;;53     	MQTTHeader header = {0};
000012  2000              MOVS     r0,#0
000014  9002              STR      r0,[sp,#8]
;;;54     	int rem_len = 0;
000016  9001              STR      r0,[sp,#4]
;;;55     	int rc = -1;
000018  1e40              SUBS     r0,r0,#1
00001a  9000              STR      r0,[sp,#0]
;;;56     	int i = 0;
00001c  2500              MOVS     r5,#0
;;;57     
;;;58     	FUNC_ENTRY;
;;;59     	if (MQTTPacket_len(rem_len = MQTTSerialize_unsubscribeLength(count, topicFilters)) > buflen)
00001e  4651              MOV      r1,r10
000020  4648              MOV      r0,r9
000022  f7fffffe          BL       MQTTSerialize_unsubscribeLength
000026  4683              MOV      r11,r0
000028  9001              STR      r0,[sp,#4]
00002a  f7fffffe          BL       MQTTPacket_len
00002e  42b0              CMP      r0,r6
000030  dd02              BLE      |L2.56|
;;;60     	{
;;;61     		rc = MQTTPACKET_BUFFER_TOO_SHORT;
000032  1ea8              SUBS     r0,r5,#2
000034  9000              STR      r0,[sp,#0]
;;;62     		goto exit;
000036  e032              B        |L2.158|
                  |L2.56|
;;;63     	}
;;;64     
;;;65     	header.byte = 0;
000038  2000              MOVS     r0,#0
00003a  f88d0008          STRB     r0,[sp,#8]
;;;66     	header.bits.type = UNSUBSCRIBE;
00003e  9802              LDR      r0,[sp,#8]
000040  f02000f0          BIC      r0,r0,#0xf0
000044  30a0              ADDS     r0,r0,#0xa0
000046  9002              STR      r0,[sp,#8]
;;;67     	header.bits.dup = dup;
000048  9802              LDR      r0,[sp,#8]
00004a  f36700c3          BFI      r0,r7,#3,#1
00004e  9002              STR      r0,[sp,#8]
;;;68     	header.bits.qos = 1;
000050  9802              LDR      r0,[sp,#8]
000052  f0200006          BIC      r0,r0,#6
000056  1c80              ADDS     r0,r0,#2
000058  9002              STR      r0,[sp,#8]
;;;69     	writeChar(&ptr, header.byte); /* write header */
00005a  f89d1008          LDRB     r1,[sp,#8]
00005e  a803              ADD      r0,sp,#0xc
000060  f7fffffe          BL       writeChar
;;;70     
;;;71     	ptr += MQTTPacket_encode(ptr, rem_len); /* write remaining length */;
000064  9901              LDR      r1,[sp,#4]
000066  9803              LDR      r0,[sp,#0xc]
000068  f7fffffe          BL       MQTTPacket_encode
00006c  9903              LDR      r1,[sp,#0xc]
00006e  4408              ADD      r0,r0,r1
000070  9003              STR      r0,[sp,#0xc]
;;;72     
;;;73     	writeInt(&ptr, packetid);
000072  4641              MOV      r1,r8
000074  a803              ADD      r0,sp,#0xc
000076  f7fffffe          BL       writeInt
;;;74     
;;;75     	for (i = 0; i < count; ++i)
00007a  2500              MOVS     r5,#0
00007c  e009              B        |L2.146|
                  |L2.126|
;;;76     		writeMQTTString(&ptr, topicFilters[i]);
00007e  eb050045          ADD      r0,r5,r5,LSL #1
000082  eb0a0c80          ADD      r12,r10,r0,LSL #2
000086  a803              ADD      r0,sp,#0xc
000088  e89c000e          LDM      r12,{r1-r3}
00008c  f7fffffe          BL       writeMQTTString
000090  1c6d              ADDS     r5,r5,#1              ;75
                  |L2.146|
000092  454d              CMP      r5,r9                 ;75
000094  dbf3              BLT      |L2.126|
;;;77     
;;;78     	rc = ptr - buf;
000096  9803              LDR      r0,[sp,#0xc]
000098  1b00              SUBS     r0,r0,r4
00009a  9000              STR      r0,[sp,#0]
;;;79     exit:
00009c  bf00              NOP      
                  |L2.158|
;;;80     	FUNC_EXIT_RC(rc);
;;;81     	return rc;
00009e  9800              LDR      r0,[sp,#0]
;;;82     }
0000a0  b004              ADD      sp,sp,#0x10
0000a2  e8bd9ff0          POP      {r4-r12,pc}
;;;83     
                          ENDP


                          AREA ||i.MQTTSerialize_unsubscribeLength||, CODE, READONLY, ALIGN=1

                  MQTTSerialize_unsubscribeLength PROC
;;;27       */
;;;28     int MQTTSerialize_unsubscribeLength(int count, MQTTString topicFilters[])
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;29     {
000004  4605              MOV      r5,r0
000006  460e              MOV      r6,r1
;;;30     	int i;
;;;31     	int len = 2; /* packetid */
000008  2702              MOVS     r7,#2
;;;32     
;;;33     	for (i = 0; i < count; ++i)
00000a  2400              MOVS     r4,#0
00000c  e00a              B        |L3.36|
                  |L3.14|
;;;34     		len += 2 + MQTTstrlen(topicFilters[i]); /* length + topic*/
00000e  eb040044          ADD      r0,r4,r4,LSL #1
000012  eb060380          ADD      r3,r6,r0,LSL #2
000016  e8930007          LDM      r3,{r0-r2}
00001a  f7fffffe          BL       MQTTstrlen
00001e  1c80              ADDS     r0,r0,#2
000020  4407              ADD      r7,r7,r0
000022  1c64              ADDS     r4,r4,#1              ;33
                  |L3.36|
000024  42ac              CMP      r4,r5                 ;33
000026  dbf2              BLT      |L3.14|
;;;35     	return len;
000028  4638              MOV      r0,r7
;;;36     }
00002a  e8bd81f0          POP      {r4-r8,pc}
;;;37     
                          ENDP

